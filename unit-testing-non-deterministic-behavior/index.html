<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width initial-scale=1">

  <title>Unit Testing Random Behavior With Mock Objects</title>
  <meta name="description" content="Unit Testing Random Behavior With Mock Objects ">

  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://jasonjl.me/css/style.css">
  <link rel="canonical" href="https://jasonjl.mehttps://jasonjl.me/unit-testing-non-deterministic-behavior/">
  <link rel="alternate" type="application/atom+xml" title="Jason Lee" href="https://jasonjl.mehttps://jasonjl.me/feed.xml" />
  <!-- Basic favicon -->
  <link rel="icon" type="image/x-icon" href="https://jasonjl.me/assets/favicon/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="https://jasonjl.me/assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://jasonjl.me/assets/favicon/favicon-16x16.png">

  <!-- Apple Touch Icon -->
  <link rel="apple-touch-icon" sizes="180x180" href="https://jasonjl.me/assets/favicon/apple-touch-icon.png">

  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZYPVTW1ZCS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZYPVTW1ZCS');
</script>

</head>

  <body>
    <div class="wrapper">
      <div class="page-content">
        <div class="post">
  <h2>Jason J Lee</h2>
  <header class="post-header">
    <a href=" https://jasonjl.me " class="home-link">← Home</a>
    <h1 class="post-title">Unit Testing Random Behavior With Mock Objects</h1>
    <p class="post-meta">November 3, 2014</p>
    
  </header>
  <div>


  </div>

  <article class="post-content">
    <h1 id="unit-testing-random-behavior-with-mock-objects">Unit Testing Random Behavior With Mock Objects</h1>

<p>What happens when you’re trying to write some unit tests and suddenly you need to test a method with non-deterministic properties. In other words how do you test a method whose expected behavior is random behavior? The answer is with mock objects. I’ve seen a bunch of suggestions to use a mock randomizer but I haven’t seen anyone actually explain it further than that. Hopefully this will help someone out</p>

<p>So when writing unit tests for methods, we need to execute these methods with test data or mock objects. These mock objects either come in through the constructor during the setup or as a method parameter when calling the method. When people say to make your random object a dependency, they mean that your random object should be an external object that is passed into the constructor or method of whatever you need to test. Since the object is being passed into the constructor, you can pass in a real non-deterministic random number generator, or a phony completely predictable deterministic ‘random number generator’.</p>

<p>In the following example I’m going to be making and testing a simple program that simply gets me a random number</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PrintRandomNumber</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Random</span> <span class="n">random</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">PrintRandomNumber</span><span class="o">(</span><span class="nc">Random</span> <span class="n">random</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">random</span> <span class="o">=</span> <span class="n">random</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getRandomInt</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>notice how the <code class="language-plaintext highlighter-rouge">PrintRandomNumber</code> constructor accepts a <code class="language-plaintext highlighter-rouge">Random random</code> parameter. This means that we can pass in any class that comes from the class Random. Usually we want to use java.util.Random during real code execution, but when testing we’ll want to mock our own random object with deterministic results. Here’s an example deterministic random class.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DeterministicRandom</span> <span class="kd">extends</span> <span class="nc">Random</span><span class="o">{</span>
    <span class="kt">int</span> <span class="n">sequentialNum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">DeterministicRandom</span><span class="o">(){</span>
        <span class="kd">super</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">nextInt</span><span class="o">(){</span>
        <span class="k">return</span> <span class="n">sequentialNum</span><span class="o">++;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The class <code class="language-plaintext highlighter-rouge">DeterministicRandom</code> extends the <code class="language-plaintext highlighter-rouge">Random</code> class with an overridden <code class="language-plaintext highlighter-rouge">nextInt()</code> method. This means that <code class="language-plaintext highlighter-rouge">DeterministicRandom</code> can be passed into the <code class="language-plaintext highlighter-rouge">PrintRandomNumber</code> constructor where by calling <code class="language-plaintext highlighter-rouge">nextInt()</code> will then give completely deterministic results. The following class is a test case to show just that.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DeterministicRandomTest</span><span class="o">{</span>
    <span class="nc">PrintRandomNumber</span> <span class="n">printRandomNumber</span>

    <span class="nd">@Before</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUp</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
        <span class="nc">DeterministicRandom</span> <span class="n">deterministicRandom</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DeterministicRandom</span><span class="o">();</span>
        <span class="n">printRandomNumber</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PrintRandomNumber</span><span class="o">(</span><span class="n">deterministicRandom</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGetRandomInt</span><span class="o">(){</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">printRandomNumber</span><span class="o">.</span><span class="na">getRandomInt</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">printRandomNumber</span><span class="o">.</span><span class="na">getRandomInt</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">printRandomNumber</span><span class="o">.</span><span class="na">getRandomInt</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">printRandomNumber</span><span class="o">.</span><span class="na">getRandomInt</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="n">printRandomNumber</span><span class="o">.</span><span class="na">getRandomInt</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="n">printRandomNumber</span><span class="o">.</span><span class="na">getRandomInt</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p>Running the JUnit test case above, I’m creating a new <code class="language-plaintext highlighter-rouge">DeterministicRandom</code> that I feed into <code class="language-plaintext highlighter-rouge">PrintRandomNumber</code>’s constructor, this way my random will always start at 0 for every test case. In the test case <code class="language-plaintext highlighter-rouge">testGetRandomInt()</code> I’m testing to see whether <code class="language-plaintext highlighter-rouge">PrintRandomNumber.getRandomInt()</code> is working as I’m expecting, and I’m expecting sequential numbers starting at zero. The test should pass since I fed <code class="language-plaintext highlighter-rouge">PrintRandomNumber</code> a completely deterministic ‘random number generator’ in the setUp, <code class="language-plaintext highlighter-rouge">printRandomNumber = new PrintRandomNumber(deterministicRandom)</code>. This allows a method that’s dependent on a random number generator to have consistent results every time you test it.</p>

<p>So there you have it, that’s how you mock a Random class. Having to pass in your random number generator class into the constructor of the object that uses it may sound counter-intuitive (I know it did to me) but I guess it makes sense. It allows your class to be more modular and definitely more testable. After all, we’re not trying to test if the random number generator is working, but rather whether your class is reacting appropriately to the numbers that come from the random number generator.</p>

<p>Happy testing.</p>

  </article>

  
  <hr>

  <div class="related">
    <h2>Other Posts</h2>
    
      <li><a href="/adventures-in-vibe-coding/" title="Adventures in Vibe Coding">Adventures in Vibe Coding
       &nbsp; <span class="post-meta">September 30, 2025</span></a>
    
      <li><a href="/fitting-room-retrospective/" title="FittingRoom Postmortem">FittingRoom Postmortem
       &nbsp; <span class="post-meta">August 20, 2025</span></a>
    
      <li><a href="/blog-migration-postmortem/" title="Blog migration postmortem">Blog migration postmortem
       &nbsp; <span class="post-meta">July 16, 2025</span></a>
    
  </div>
  
  <div class="comments">
    <div id="disqus_thread"></div>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://jihoon222.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  </div>
</div>

<script>
var anchorForId = function (id) {
  var anchor = document.createElement("a");
  anchor.className = "header-link";
  anchor.href      = "#" + id;
  anchor.innerHTML = "<i class=\"fas fa-link\"></i>";
  return anchor;
};

var linkifyAnchors = function (level, containingElement) {
  var headers = containingElement.getElementsByTagName("h" + level);
  for (var h = 0; h < headers.length; h++) {
    var header = headers[h];

    if (typeof header.id !== "undefined" && header.id !== "") {
      header.appendChild(anchorForId(header.id));
    }
  }
};

document.onreadystatechange = function () {
  if (this.readyState === "complete") {
    linkifyAnchors(3, document.body);
    linkifyAnchors(4, document.body);
    linkifyAnchors(5, document.body);
    linkifyAnchors(6, document.body);
  }
};
</script>

      </div>
    </div>
  </body>
</html>
